<template name="cartCheckout">
  {{#if cart.items}}

    <div class="checkout-progress">
      <div class="container">
        {{>checkoutProgressBar}}
      </div>
    </div>

    <div class="checkout-cart">
      <div class="container">
        {{>checkoutCartDrawer}}
      </div>
    </div>

    <div class="checkout">
      <div class="container container-lg">
        <div class="checkout-steps">
          <div class="checkout-steps-main">
            {{#each reactionTemplate workflow="coreCartWorkflow" container="checkout-steps-main"}}
              {{> checkoutSteps}}
            {{/each}}
          </div>

          <div class="checkout-steps-side">
            {{#each reactionTemplate workflow="coreCartWorkflow" container="checkout-steps-side"}}
              {{> checkoutSteps}}
            {{/each}}
          </div>
        </div>
      </div>
    </div>
  {{else}}
    {{> emptyCheckoutCart}}
  {{/if}}
</template>

<template name="checkoutCartDrawerItems">
<div class="cart-items" id="{{productId}}{{variants._id}}">
  <div class="cart-labels" style="margin:0px">
    {{#if cart.showItemLowInventoryWarning variants}}
    <div class="badge badge-low-inv-warning" title="{{variants.inventoryQuantity}}" data-i18n="cartDrawerItems.left">!</div>
    {{/if}}
    <span class="badge">{{quantity}}</span>
    <span class="cart-item-title">
        <a
          href="{{pathFor 'product' handle=productId variantId=variants._id}}"
          data-event-category="cart"
          data-event-action="product-click"
          data-event-label="Cart product click"
          data-event-value="{{productId}}"
        >{{title}} <small>{{variants.title}}</small></a>
    </span>
  </div>
  {{#if variants.metafields}}
  <div class="meta-data">
    {{#each variants.metafields}}
    <div className="meta-item">
      <span className="meta-key">{{key}}</span>:
      <span className="meta-value">{{value}}</span>
    </div>
    {{/each}}
  </div>
  {{/if}}
</div>
</template>



<template name="checkoutCartDrawer">
<div class="cart-drawer" id="cart-drawer">
  <div class="cart-drawer-swiper-container" style="height:auto;overflow:auto">
    <div class="cart-drawer-swiper-wrapper" style="text-align:left">
      <div class="cart-drawer-swiper-slide" style="float:none;display:inline-block;vertical-align:top">
        {{>cartSubTotals}}
      </div>
      {{#each cartItems}}
      <div class="cart-drawer-swiper-slide" style="height:auto;float:none;display:inline-block;vertical-align:top">
        {{>checkoutCartDrawerItems}}
      </div>
      {{/each}}
    </div>
  </div>
  <div class="cart-drawer-pagination"></div>
</div>
</template>


<template name="checkoutSteps">
    {{#if isPending }}

      <div class="checkout-step">
        {{> Template.dynamic template=template}}
      </div>

    {{else}}

      {{#if isCompleted}}
        <div class="checkout-step-completed">
          {{> Template.dynamic template=template}}
        </div>
      {{else}}
        <div class="checkout-step-pending">
          {{> checkoutStepPending}}
        </div>
      {{/if}}

    {{/if}}
</template>


<template name="checkoutStepPending">
  <div class="panel panel-default">
    <div class="panel-heading">
      {{> checkoutStepBadge}}
    </div>
  </div>
</template>

<template name="emptyCheckoutCart">
  <div class="container-fluid-sm">
    <div class="empty-view-message">
      <i class="fa fa-barcode"></i>
      <p data-i18n="cartCheckout.surprise">Woah!</p>
      <p data-i18n="cartCheckout.emptyCheckoutCart">Your cart is empty.</p>
    </div>
  </div>
</template>


<template name="checkoutStepBadge">
  <i class="checkout-step-badge {{checkoutStepBadgeClass}}">{{position}}</i>
</template>
